#/bin/bash

umask 022
sudo echo root

locations=host
if [ $HOSTNAME = apple ]
then
    locations=guest
fi

for level in 1 2 3 4 5 6 7 8 9 ''
do
    for location in all $locations
    do
        suffix=-$location
        if [ $location = all ]
        then
            suffix=''
        fi
        for upgrade in $SMITHHOME/*/upgrade${level}${suffix}.bash
        do
            if [ ! -f ${upgrade} ]
            then
                continue
            fi
            lib=$(dirname ${upgrade})
            src=$(basename ${lib})
            pushd ${src}
            bash ${upgrade}
            popd
        done
    done
done

pushd /run/shm
echo shebang
grep /usr/bin/python ~/.local/bin/*
echo py2
grep /usr/bin/python ~/.local/bin/* | grep -v /usr/bin/python3
ls -lt ~/.local/bin/ /usr/local/bin/ ~/builds/fontvalidator/bin
find /usr/local/lib -name fontforge* -exec ls -l {} \;
find /usr/local/lib -name psMat* -exec ls -l {} \;
popd

# Use the latest fontTools
pip3 show fonttools

# Install fontmake (again) in a virtual environment
rm -rf fourplus
python3 -m venv fourplus
source fourplus/bin/activate
pip3 install fontmake
pip3 install MutatorMath
